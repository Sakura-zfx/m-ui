!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var n in i)("object"==typeof exports?exports:t)[n]=i[n]}}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=260)}({0:function(t,e,i){"use strict";e.a=function(t,e,i,n,o,s,r,a){var c=typeof(t=t||{}).default;"object"!==c&&"function"!==c||(t=t.default);var l,h="function"==typeof t?t.options:t;e&&(h.render=e,h.staticRenderFns=i,h._compiled=!0);n&&(h.functional=!0);s&&(h._scopeId=s);r?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},h._ssrRegister=l):o&&(l=a?function(){o.call(this,this.$root.$options.shadowRoot)}:o);if(l)if(h.functional){h._injectStyles=l;var d=h.render;h.render=function(t,e){return l.call(e),d(t,e)}}else{var f=h.beforeCreate;h.beforeCreate=f?[].concat(f,l):[l]}return{exports:t,options:h}}},185:function(t,e,i){"use strict";e.a={data:function(){return{dataList:[],dataShowList:[],pageSize:0,totalItemNum:0,rowInScreenNum:0,wrapHeight:0,screenItemHeight:0,lastScrollTop:0,fromIndex:0,toIndex:0,lastPaddingObj:null}},props:{fnFetch:{type:Function,required:!0},itemHeight:{type:Number,default:50},loading:{type:Boolean,required:!0,default:!1}},computed:{containerPadding:function(){var t=this.fromIndex*this.itemHeight;return this.loading&&this.lastPaddingObj?this.lastPaddingObj.paddingBottom=0:this.lastPaddingObj={paddingTop:t+"px",paddingBottom:this.wrapHeight-t-this.itemHeight*this.pageSize+"px"},this.lastPaddingObj}},created:function(){this.getData()},mounted:function(){var t=this.$refs.container.offsetHeight;if(this.rowInScreenNum=Math.ceil(t/this.itemHeight),this.screenItemHeight=this.rowInScreenNum*this.itemHeight,this.pageSize=this.toIndex=2*this.rowInScreenNum,this.pageSize<this.toIndex)throw"当前滚动容器内一屏渲染"+this.rowInScreenNum+"条，pageSize必须至少为它的2倍14条"},methods:{changeLoading:function(t){this.$emit("update:loading",t)},getData:function(){var t=this;this.fetch().then(function(e){t.changeLoading(!0),t.dataList=t.dataList.concat(e),t.totalItemNum=t.dataList.length,t.setSliceData(),t.wrapHeight=t.totalItemNum*t.itemHeight})},fetch:function(){return this.fnFetch(this.dataList).then(function(t){if(!Array.isArray(t))throw"fn-fetch方法resolve的data必须为数组";return t})},setSliceData:function(){this.dataShowList=this.dataList.slice(this.fromIndex,this.toIndex)},handleMove:function(t){var e=t.target.scrollTop;if(!this.loading)if(Math.abs(e-this.lastScrollTop)>this.screenItemHeight){this.lastScrollTop=e;var i=Math.floor(this.lastScrollTop/this.screenItemHeight);i>0&&(this.fromIndex=i*this.rowInScreenNum,this.toIndex=this.fromIndex+this.pageSize,this.toIndex>=this.dataList.length?(console.log("get data, this.fromIndex",this.fromIndex,"this.toIndex",this.toIndex),this.getData()):this.setSliceData())}else{var n=Math.floor(this.lastScrollTop/e);n>0&&(console.log("up count",n),this.lastScrollTop-=this.screenItemHeight,this.lastScrollTop<this.screenItemHeight&&(this.lastScrollTop=0),this.fromIndex-=n*this.rowInScreenNum,this.fromIndex<0&&(this.fromIndex=0),this.toIndex=this.fromIndex+this.pageSize,this.setSliceData())}}}}},260:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(185),o=i(262),s=i(0);var r=function(t){i(261)},a=Object(s.a)(n.a,o.a,o.b,!1,r,null,null);e.default=a.exports},261:function(t,e){},262:function(t,e,i){"use strict";i.d(e,"a",function(){return n}),i.d(e,"b",function(){return o});var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"container",staticClass:"scroll-container",on:{scroll:t.handleMove}},[i("div",{staticClass:"scroll-container__wrap",style:t.containerPadding},[t._l(t.dataShowList,function(e){return i("div",{key:e.id,staticClass:"scroll-container__item",style:{height:t.itemHeight+"px"}},[t._t("default",null,{row:e})],2)}),t._v(" "),t.loading?i("p",{staticClass:"loading"},[t._v("loading...")]):t._e()],2)])},o=[]}})});